jobs:
  - name: manifest-job
    type: manifest
    steps:
      - IN: nginx-image

  - name: GKE-deploy
    type: deploy
    method: blueGreen
    stabilityDuration: 60 # (seconds)
    maxWaitTime: 4 # (seconds)    
    steps:
      - IN: manifest-job
      - IN: GKE-cluster
      - IN: scaler

resources:
  - name: scaler
    type: replicas
    version:
      count: 1

  - name: nginx-image
    type: image
    integration: "docker-subint"
    pointer:
      sourceName: "ankul/nginx"
    seed:
      versionName: prod.10

  - name: GKE-cluster
    type: cluster
    integration: "gke-subint"
    pointer:
      sourceName: "gke-cluster"
      region: "us-central1-a"
      bastionHost:
        address: 35.226.229.205
        user: ankul
        keyIntegration: "bastion-access"      
      
  - name: bastion-access
    type: integration
    integration: "bastion-access-keys"
